<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Django ç·´ç¿’ç­†è¨˜ | Gridea</title>
<link rel="shortcut icon" href="https://WeiBoHaung.github.io/favicon.ico?v=1611213604553">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://WeiBoHaung.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Django ç·´ç¿’ç­†è¨˜ | Gridea - Atom Feed" href="https://WeiBoHaung.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="Django ç·´ç¿’ç­†è¨˜



ç’°å¢ƒ





Pycharm
Pofessional


Python
3.7.3


Django
3.0.4



ç°¡ä»‹
å…ˆä¾†èªè­˜ä¸€ä¸‹ Django çš„è¨­è¨ˆæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯ MTVï¼Œ


Model : å®šç¾©..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://WeiBoHaung.github.io">
  <img class="avatar" src="https://WeiBoHaung.github.io/images/avatar.png?v=1611213604553" alt="">
  </a>
  <h1 class="site-title">
    Gridea
  </h1>
  <p class="site-description">
    æ¸©æ•…è€ŒçŸ¥æ–°
  </p>
  <div class="menu-container">
    
      
        <a href="https://WeiBoHaung.github.io" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Django ç·´ç¿’ç­†è¨˜
            </h2>
            <div class="post-info">
              <span>
                2021-01-21
              </span>
              <span>
                6 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="django-ç·´ç¿’ç­†è¨˜">Django ç·´ç¿’ç­†è¨˜</h1>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Pycharm</td>
<td>Pofessional</td>
</tr>
<tr>
<td>Python</td>
<td>3.7.3</td>
</tr>
<tr>
<td>Django</td>
<td>3.0.4</td>
</tr>
</tbody>
</table>
<h2 id="ç°¡ä»‹">ç°¡ä»‹</h2>
<p>å…ˆä¾†èªè­˜ä¸€ä¸‹ Django çš„è¨­è¨ˆæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯ MTVï¼Œ</p>
<ul>
<li>
<p>Model : å®šç¾©ä¸€äº›è³‡æ–™åº«çš„æ±è¥¿ ( ORM )ï¼Œé€™å±¤é€šå¸¸æ˜¯ç›´æ¥å’Œè³‡æ–™æœ‰é—œã€‚</p>
</li>
<li>
<p>Template : ä½¿ç”¨è€…åŸºæœ¬ä¸Šå°±æ˜¯çœ‹åˆ°é€™å±¤ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‰€å‘ˆç¾çš„ Template ( html )ã€‚</p>
</li>
<li>
<p>View : å¯ä»¥å°‡é€™å±¤çœ‹åšæ˜¯ä¸­é–“å±¤ï¼Œå®ƒä¸»è¦è² è²¬ Model å’Œ Template ä¹‹é–“çš„æ¥­å‹™é‚è¼¯ã€‚</p>
</li>
</ul>
<p>ä»‹ç´¹äº† Django çš„è¨­è¨ˆæ¨¡å¼ï¼Œæ¥ä¸‹ä¾†ä½ ä¸€å®šæœƒå•ï¼Œé‚£é€™æœ‰ä»€éº¼å¥½è™• â“</p>
<p>æœ€ç›´æ¥çš„å¥½è™•å°±æ˜¯ï¼Œæˆ‘å€‘å¯ä»¥å¾ˆæ˜ç¢ºä¸”å¾ˆå¿«é€Ÿçš„çŸ¥é“å•é¡Œåœ¨å“ªè£¡ï¼Œä¾‹å¦‚ï¼Œä»Šå¤©å¯èƒ½é é¢å‡ºäº†å•é¡Œï¼Œ<br>
é€™æ¨£æˆ‘å€‘å°±æœƒçŸ¥é“è¦å…ˆå» template ä¸­æ‰¾å•é¡Œï¼Œè€Œå¦‚æœæ˜¯é—œæ–¼è³‡æ–™åº«çš„å•é¡Œï¼Œå‰‡å¯èƒ½å°±è¦å…ˆå» Model</p>
<p>ä¸­æ‰¾ï¼Œç¸½ä¹‹ï¼Œå°±æ˜¯ä¸æœƒåƒä¸€éš»ç„¡é ­è’¼è …ä¸€æ¨£ä¸çŸ¥é“è¦å»å“ªè£¡æ‰¾å•é¡Œâ˜ºï¸</p>
<p>æœ€å¾Œç°¡å–®å°‡ Django çš„ MTV å’Œ ASP.NET ä¸­çš„ MVC æ¯”è¼ƒä¸€ä¸‹ï¼Œ</p>
<table>
<thead>
<tr>
<th>MTV</th>
<th>MVC</th>
</tr>
</thead>
<tbody>
<tr>
<td>Model</td>
<td>Model</td>
</tr>
<tr>
<td>Template</td>
<td>View</td>
</tr>
<tr>
<td>View</td>
<td>Controller</td>
</tr>
</tbody>
</table>
<p>å…¶å¯¦å¯ä»¥å°‡ MTV æƒ³æˆç®—æ˜¯ MVC çš„è®Šå½¢ ğŸ˜</p>
<h2 id="æ•™å­¸">æ•™å­¸</h2>
<ol>
<li>
<p>å»ºç«‹å°ˆæ¡ˆDjango Project</p>
<p>å»ºè­°ç›´æ¥å®‰è£ PyCharm Pofessionalï¼Œç„¶å¾Œæ–°å¢ä¸€å€‹ Django Project</p>
<figure data-type="image" tabindex="1"><img src="https://i.imgur.com/nW1QDBR.png" alt="" loading="lazy"></figure>
<p>ç”¨ PyCharm Pofessional å»ºç«‹ project é‚„æœ‰ä¸€å€‹å¥½è™•ï¼Œå°±æ˜¯ä¸€äº›è¨­å®šæœƒå…ˆå¹šä½ è¨­å®šå¥½ï¼Œä¸ç”¨å…¨éƒ¨é‡æ–°è‡ªå·±å‹•æ‰‹è¨­è¨­å®šã€‚</p>
<p>ä½†æ˜¯åªæœ‰ PyCharm Professional æ‰æœ‰é€™å€‹åŠŸèƒ½ï¼Œå¦‚æœä½ æ˜¯å®‰è£ä¸€èˆ¬çš„ PyCharm Community Editionï¼Œå‰‡æ²’æœ‰é€™å€‹é¸é …ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<p>åœ¨Terminalè¼¸å…¥æŒ‡ä»¤å»ºç«‹å°ˆæ¡ˆ</p>
<pre><code> django-admin startproject django_tutorial
</code></pre>
<p>åŸ·è¡ŒDjango</p>
<pre><code> python manage.py runserver
</code></pre>
</li>
<li>
<p>å»ºç«‹Django App</p>
<p>åœ¨ Django ä¸­ï¼Œé€šå¸¸æˆ‘å€‘æœƒä¾ç…§ åŠŸèƒ½ å»å»ºè­°ä¸€å€‹ App ï¼Œ ä¾‹å¦‚ç¯„ä¾‹çš„ musics ï¼Œä»£è¡¨ä»–æ˜¯ ç®¡ç†éŸ³æ¨‚ çš„éƒ¨ä»½ã€‚</p>
<p><strong>è«‹åœ¨ä½ çš„Terminalåº•ä¸‹è¼¸å…¥</strong></p>
<pre><code>    python manage.py startapp musics
</code></pre>
<p>åŸ·è¡Œå¾Œï¼Œæœƒç™¼ç¾å°ˆæ¡ˆåº•ä¸‹æœƒå…ˆå¢æ–°è³‡æ–™å¤¾<br>
<img src="https://i.imgur.com/fAH3HQr.png" alt="" loading="lazy"></p>
<p><strong>å»ºç«‹å®Œæˆå¾Œåœ¨AppåŠ å…¥è¨­å®šæª”</strong></p>
<p>è«‹åœ¨settings.pyè£¡é¢INSTALLED_APPSåŠ å…¥å‰›å‰›çš„APP<br>
<img src="https://i.imgur.com/9wEVWAQ.png" alt="" loading="lazy"></p>
<p><strong>åœ¨templatesæ–°å¢View</strong></p>
<p>flaskæœƒå…ˆåˆ°å°ˆæ¡ˆè³‡æ–™å¤¾ã€templatesã€å»å°‹æ‰¾ç›¸å°æ‡‰çš„htmlæ–‡ä»¶ï¼Œå› æ­¤ï¼Œä½ éœ€è¦å…ˆåšçš„å°±æ˜¯åœ¨å°ˆæ¡ˆåº•ä¸‹å»ºç½®ä¸€å€‹è³‡æ–™å¤¾ï¼Œä¸¦ä¸”å‘½åç‚ºã€templatesã€ã€‚<br>
<img src="https://i.imgur.com/O6VdPDL.png" alt="" loading="lazy"></p>
<p>è«‹å…ˆåœ¨ templates è£¡é¢æ–°å¢ä¸€å€‹ hello_django.htmlï¼Œä¸¦åœ¨è£¡é¢è¼¸å…¥ä¸‹æ–¹ç¨‹å¼ç¢¼ï¼š</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {{data}}
&lt;/body&gt;
</code></pre>
<p>hello_django.html è£¡é¢çš„{{data}}ï¼Œåªæ˜¯é€é views.py å‚³å€¼éä¾†è€Œå·²ã€‚</p>
<p>æ¥è‘—æˆ‘å€‘å°‡views.pyè£¡é¢æ–°å¢ä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š</p>
<pre><code>from django.shortcuts import render

# æ–°å¢ä½ çš„view.
def hello_view(request):
    return render(request,'hello_django.html',{
            'data':&quot;Hello Django&quot;,
        })

</code></pre>
<p>é€éflaskçš„renderå‡½æ•¸æ¸²æŸ“æ¨¡æ¿ï¼Œå› æ­¤å®ƒéœ€è¦ä¸€å€‹ã€æ¨¡æ¿ã€ä¾†æä¾›æ¸²æŸ“çš„æ ¼å¼ï¼Œflaskæœƒå…ˆåˆ°å°ˆæ¡ˆè³‡æ–™å¤¾ã€templatesã€å»å°‹æ‰¾ç›¸å°æ‡‰çš„htmlæ–‡ä»¶ã€‚</p>
<p>æˆæœå¦‚ä¸‹åœ–ï¼š<br>
<img src="https://i.imgur.com/0bc1hch.png" alt="" loading="lazy"></p>
<p><strong>æ–°å¢Router</strong></p>
<p>åœ¨ urls.py è£¡é¢å¢åŠ ä¸€ä¸Šå°æ‡‰è·¯ç”±ï¼Œå¦‚ä¸‹ï¼š<br>
<img src="https://i.imgur.com/a36Vgbt.png" alt="" loading="lazy"></p>
<pre><code>from django.contrib import admin
from django.urls import path
from musics.views import hello_view

urlpatterns = [
    path('admin/', admin.site.urls),
    path('hello/',hello_view),
]

</code></pre>
<p><strong>from musics.views import hello_viewr</strong>å°‡musicsè³‡æ–™å¤¾åº•ä¸‹çš„views.pyå¼•å…¥</p>
<p>åœ¨urlpatterns listä¸­æ–°å¢è·¯å¾‘path('hello/',hello_view)</p>
<p>æœ€å¾ŒåŸ·è¡Œ Django ï¼Œ ç„¶å¾Œç€è¦½ http://127.0.0.1:8000/hello/</p>
</li>
<li>
<p>Models</p>
<p>å®šç¾©å‡ºè³‡æ–™åº«ä¸­çš„çµæ§‹ï¼ˆschemaï¼‰ï¼Œä¸¦ä¸”é€é Django ä¸­çš„æŒ‡ä»¤å»å»ºç«‹è³‡æ–™åº«ã€‚Django é è¨­æ˜¯ä½¿ç”¨ SQLite ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ç‚ºå…¶ä»–çš„è³‡æ–™åº«ï¼Œå¯ä»¥åœ¨ settings.py è£¡é¢é€²è¡Œä¿®æ”¹ã€‚é¦–å…ˆï¼Œè«‹å…ˆåœ¨ models.py è£¡é¢å¢åŠ ä¸‹æ–¹ç¨‹å¼ç¢¼:</p>
<pre><code>from django.db import models


# Create your models here.
class Music(models.Model):
    song = models.TextField(default=&quot;song&quot;)
    singer = models.TextField(default=&quot;AKB48&quot;)
    last_modify_date = models.DateTimeField(auto_now=True)
    created = models.DateTimeField(auto_now_add=True)

    class Meta:
        db_table = &quot;music&quot;
</code></pre>
<p>default : ä»£è¡¨é»˜èªå€¼ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä½ æ²’æœ‰æŒ‡å®šçš„è©±æœƒç”¨é»˜èªå€¼ã€‚</p>
<p>auto_now_add : æ–°å¢æ™‚æœƒå¹šä½ è‡ªå‹•åŠ ä¸Šå»ºç«‹æ™‚é–“ã€‚</p>
<p>auto_now : è³‡æ–™æœ‰æ›´æ–°æ™‚æœƒå¹šä½ è‡ªå‹•åŠ ä¸Šæ›´æ–°çš„æ™‚é–“ã€‚</p>
<p>æ¥è‘—åœ¨Terminalè¼¸å…¥</p>
<pre><code> python manage.py makemigrations
 python manage.py migrate
</code></pre>
<p>makemigrations ï¼š æœƒå¹šä½ å»ºç«‹ä¸€å€‹æª”æ¡ˆï¼Œå»è¨˜éŒ„ä½ æ›´æ–°äº†å“ªäº›æ±è¥¿ã€‚</p>
<p>migrate ï¼š æ ¹æ“š makemigrations å»ºç«‹çš„æª”æ¡ˆï¼Œå»æ›´æ–°ä½ çš„ DATABASE ã€‚</p>
<p>è¼¸å…¥å®Œå¾Œåœ¨pycharmè¨­å®šdatabaseé¡¯ç¤º:<br>
<img src="https://i.imgur.com/RbIHzH3.png" alt="" loading="lazy"><br>
é¸æ“‡å°ˆæ¡ˆåº•ä¸‹çš„db.sqlite3<br>
<img src="https://i.imgur.com/WUbtPQk.png" alt="" loading="lazy"><br>
æ³¨æ„ï¼šå¦‚é»ƒè‰²åŒ¡å€åŸŸæœ‰çœ‹è«‹é»æ“Šä¸‹è¼‰ç¼ºå°‘å¥—ä»¶<br>
è¨­å®šå¾Œå®Œæˆå¦‚ä¸‹ï¼š</p>
<p>æœƒå‡ºç¾å‰›å‰›å»ºç«‹çš„è³‡æ–™è¡¨<br>
<img src="https://i.imgur.com/2uCA3dv.png" alt="" loading="lazy"></p>
<p><strong>Django ORM</strong></p>
<p><a href="https://docs.djangoproject.com/en/1.10/ref/models/querysets/">Django QuerySet API</a> å¯ä»¥è®“ä½ ç°¡å–®çš„è™•ç† CRUD ã€‚</p>
<p>ç›´æ¥ä½¿ç”¨ Python Console ï¼š</p>
<p>é¦–å…ˆå¿…é ˆå…ˆ import ä½ çš„ models</p>
<pre><code> from musics.models import Music
</code></pre>
<p><strong>Create</strong></p>
<pre><code> Music.objects.create(song='song1', singer='testsinger')
</code></pre>
<p><strong>Read</strong></p>
<pre><code> Music.objects.all()
 or
 Music.objects.get(pk=1)
 or
 Music.objects.filter(id=1)
</code></pre>
<p><strong>Update</strong></p>
<pre><code> data=Music.objects.filter(id=1)
 data.update(song='song_update')
</code></pre>
<p><strong>Delete</strong></p>
<pre><code> data=Music.objects.filter(id=4)
 data.delete()
</code></pre>
</li>
<li>
<p>Admin Site</p>
<p>Django å…§å»ºæœ‰å¾Œå°ç®¡ç†ä»‹é¢ã€‚</p>
<p>è«‹å…ˆç¢ºå®š settings.py è£¡çš„ INSTALLED_APPS è£¡æœ‰ django.contrib.admin<br>
<img src="https://i.imgur.com/FHWhb1l.png" alt="" loading="lazy"></p>
<p>è¨­å®šè·¯ç”±<br>
<img src="https://i.imgur.com/lxyTBx5.png" alt="" loading="lazy"></p>
<p>æ¥è‘—ä½¿ç”¨Terminalå»ºç«‹å¸³è™Ÿ</p>
<pre><code> python manage.py createsuperuser
</code></pre>
<p>éœ€è¦è¼¸å…¥å¸³è™Ÿã€ä¿¡ç®±ã€å¯†ç¢¼</p>
<p><strong>è¨»å†Š model</strong></p>
<p>æˆ‘å€‘å¯ä»¥è¨»å†Š modelï¼Œè®“å¾Œå°å¯ä»¥æ“ä½œ database<br>
è«‹åœ¨ admin.py è£¡é¢æ–°å¢ä¸‹æ–¹ç¨‹å¼ç¢¼ï¼Œé€™æ®µç¨‹å¼ç¢¼åªæ˜¯å»è¨»å†Š model è€Œå·²</p>
<pre><code>from django.contrib import admin

# Register your models here.
from django.contrib import admin
from musics.models import Music

admin.site.register(Music)
</code></pre>
<p>æ¥è‘—åŸ·è¡Œ Django ï¼Œç„¶å¾Œåˆ° http://127.0.0.1:8000/admin/</p>
<p>æ‡‰è©²æœƒçœ‹åˆ°ä¸‹åœ–ï¼Œè¼¸å…¥å‰›å‰›çš„å¸³è™Ÿ/å¯†ç¢¼</p>
<figure data-type="image" tabindex="2"><img src="https://i.imgur.com/9gXSZ5R.png" alt="" loading="lazy"></figure>
<p>ç™»å…¥å¾Œå°±æœƒç™¼ç¾å‰›å‰›æ–°å¢çš„è³‡æ–™è¡¨äº†<br>
<img src="https://i.imgur.com/H4IDZC9.png" alt="" loading="lazy"></p>
</li>
<li>
<p>Integrating Django with a legacy database</p>
<p>å¦‚æœèªªç¾åœ¨æˆ‘å€‘å·²ç¶“æœ‰ä¸€å€‹ dbï¼Œéœ€è¦å»ºç«‹ model è®“ä»– map åˆ° dbï¼Œé€™æ™‚å€™ä¸å¯èƒ½æ‰‹å‹•ä¸€å€‹ä¸€å€‹æ‰“<br>
ï¼Œå¥½åœ¨ Django æœ‰æä¾›ä¸€å€‹æ–¹æ³•è®“æˆ‘å€‘å°‡æ—¢æœ‰çš„ db è½‰åŒ–æˆ model ï¼Œæˆ‘å€‘åªéœ€è¦ä½¿ç”¨ä»¥ä¸‹çš„æŒ‡ä»¤ï¼š</p>
<pre><code> python manage.py inspectdb &gt; models.py
</code></pre>
<p>é€™æ™‚å€™ä½ å¯ä»¥æ‰“é–‹ models.pyï¼Œä½ æ‡‰è©²æœƒçœ‹åˆ° map åˆ°ä½  db çš„ modelã€‚</p>
</li>
</ol>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#django-%E7%B7%B4%E7%BF%92%E7%AD%86%E8%A8%98">Django ç·´ç¿’ç­†è¨˜</a>
<ul>
<li><a href="#%E7%B0%A1%E4%BB%8B">ç°¡ä»‹</a></li>
<li><a href="#%E6%95%99%E5%AD%B8">æ•™å­¸</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://WeiBoHaung.github.io/post/hello-gridea/">
              <h3 class="post-title">
                Hello Gridea
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://WeiBoHaung.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
